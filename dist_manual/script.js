(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();const nt={disk:function(e,t,n){this.beginPath(),this.arc(e,t,n,0,Math.PI*2),this.fill()},circle:function(e,t,n){this.beginPath(),this.arc(e,t,n,0,Math.PI*2),this.stroke()},lineDir:function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n.x*i,t+n.y*i),this.stroke()},line:function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(n,i),this.stroke()},fontSize:function(e){this.font=e+"em Calibri"},textCenter:function(){this.textAlign="center",this.textBaseline="middle"},bubbleGradient:function(e,t,n,i){const o=this.createRadialGradient(e+n/2,t-n/2,n/13,e,t,n);o.addColorStop(0,"white"),o.addColorStop(1,i),this.fillStyle=o}};function it(e){for(const[t,n]of Object.entries(nt))e[t]=n.bind(e)}const u={x:0,y:0,down:!1,up:!1,pressed:!1,wheel:0};let L=[];function ot(e){e.addEventListener("mousedown",t=>{u.x=t.offsetX,u.y=t.offsetY,u.down=!0,u.pressed=!0}),e.addEventListener("mouseup",t=>{u.x=t.offsetX,u.y=t.offsetY,u.up=!0,u.pressed=!1}),e.addEventListener("mousemove",t=>{u.x=t.offsetX,u.y=t.offsetY}),e.addEventListener("wheel",t=>{u.wheel=t.deltaY}),e.addEventListener("keydown",t=>{L[t.key]||(L[t.key]={}),L[t.key].down=!0,L[t.key].pressed=!0;const n=pe.keyDown[t.key];n&&n()}),e.addEventListener("keyup",t=>{L[t.key]||(L[t.key]={}),L[t.key].up=!0,L[t.key].pressed=!1;const n=pe.keyUp[t.key];n&&n()})}function lt(){u.up=!1,u.down=!1,u.wheel=0;for(const e of L)e.up=!1,e.down=!1}let pe={};function ue(e,t){pe.keyUp[e]=t}function $e(){pe={keyDown:{},keyUp:{}}}$e();function x(e,t){return Math.floor(Math.random()*(t-e)+e)}function Re(e,t,n){return e<t?t:e>n?n:e}function p(e,t){return{x:e,y:t}}function st(e){return(e.x**2+e.y**2)**(1/2)}function rt(e,t,n,i){return st(p(n-e,i-t))}function ye(e,t){if(typeof e=="object"&&(t=e.y,e=e.y),e==0||t==0)return p(0,0);const n=Math.sqrt(e*e+t*t);return p(e/n,t/n)}function Me(e,t){const n=ye(e.x,e.y);switch(typeof t){case"object":return{x:n.x*t.x,y:n.y*t.y};case"number":return{x:n.x*t,y:n.y*t};default:return null}}function K(e){return`hsla(${e}, 100%, 80%, 1)`}const ft=(...e)=>je(Ie(...e)),je=(...e)=>{let t=ae.createBufferSource(),n=ae.createBuffer(e.length,e[0].length,m);return e.map((i,o)=>n.getChannelData(o).set(i)),t.buffer=n,t.connect(ae.destination),t.start(),t},Ie=(e=1,t=.05,n=220,i=0,o=0,l=.1,f=0,r=1,c=0,z=0,S=0,_=0,C=0,D=0,T=0,X=0,y=0,q=1,v=0,H=0)=>{let g=2*Math.PI,ie=c*=500*g/m**2,oe=(0<T?1:-1)*g/4,Y=n*=(1+2*t*Math.random()-t)*g/m,$=[],P=0,Z=0,h=0,j=1,et=0,tt=0,E=0,le,W;for(i=99+m*i,v*=m,o*=m,l*=m,y*=m,z*=500*g/m**3,T*=g/m,S*=g/m,_*=m,C=m*C|0,W=i+v+o+l+y|0;h<W;$[h++]=E)++tt%(100*X|0)||(E=f?1<f?2<f?3<f?Math.sin((P%g)**3):Math.max(Math.min(Math.tan(P),1),-1):1-(2*P/g%2+2)%2:1-4*Math.abs(Math.round(P/g)-P/g):Math.sin(P),E=(C?1-H+H*Math.sin(2*Math.PI*h/C):1)*(0<E?1:-1)*Math.abs(E)**r*e*ut*(h<i?h/i:h<i+v?1-(h-i)/v*(1-q):h<i+v+o?q:h<W-y?(W-h-y)/l*q:0),E=y?E/2+(y>h?0:(h<W-y?1:(W-h)/y)*$[h-y|0]/2):E),le=(n+=c+=z)*Math.sin(Z*T-oe),P+=le-le*D*(1-1e9*(Math.sin(h)+1)%2),Z+=le-le*D*(1-1e9*(Math.sin(h)**2+1)%2),j&&++j>_&&(n+=S,Y+=S,j=0),!C||++et%C||(n=Y,c=ie,j=j||1);return $},ut=.1,m=44100;let ae=null;//! ZzFXM (v2.0.3) | (C) Keith Clark | MIT | https://github.com/keithclark/ZzFXM
const at=(e,t,n,i=125)=>{let o,l,f,r,c,z,S,_,C,D,T,X,y,q,v=0,H=[],g=[],ie=[],oe=0,Y=0,$=1,P={},Z=m/i*60>>2;for(;$;oe++)H=[$=_=X=0],n.map((h,j)=>{for(S=t[h][oe]||[0,0,0],$|=!!t[h][oe],q=X+(t[h][0].length-2-!_)*Z,y=j==n.length-1,l=2,r=X;l<S.length+y;_=++l){for(c=S[l],C=l==S.length+y-1&&y||D!=(S[0]||0)|c|0,f=0;f<Z&&_;f++>Z-99&&C?T+=(T<1)/99:0)z=(1-T)*H[v++]/2||0,g[r]=(g[r]||0)-z*Y+z,ie[r]=(ie[r++]||0)+z*Y+z;c&&(T=c%1,Y=S[1]||0,(c|=0)&&(H=P[[D=S[v=0]||0,c]]=P[[D,c]]||(o=[...e[D]],o[2]*=2**((c-12)/12),c>0?Ie(...o):[])))}X=q});return[g,ie]},dt={interact:[.4,0,55,.03,.01,.03,4,2,,6,-353,.11,,,,,,.55,.03,,-604],shoot:[,,354,,,0,,3.6,-6,5,,,,,,,,0,.19],explode:[.3,.3,,.02,.27,.41,,3.7,7,,,,.21,,,.3,,.4,.27]};let de=!1;function ht(){ae=new(top.AudioContext||webkitAudioContext),ke=at([[,0,300,,,.3,,2,,,,,.1,,1,,.4,,.1,.2]],[[[,,15,19,22,20,19,15,19,17,15,12,15,22,20,24,22,20,19,15,17,26,27,31,34,22,24,20,22,19,15,27,26,,],[,,15,,10,,12,,7,,8,,3,,8,,10,,15,,10,,12,,7,,8,,3,,8,,10,,]]],[0],25,{title:"Canon In D",instruments:["0"],patterns:["0"]})}function Ae(){de=!de,de?Ne():Le()}function J(e){de||ft(...dt[e])}let ke,se;function Le(){ke&&(se&&se.stop(),se=je(...ke),se.loop=!0)}window.addEventListener("focus",()=>Le());window.addEventListener("blur",()=>Ne());function Ne(){se.stop()}let Q=[];function ct(e){const t=x(30,200);Q.push({x:x(0,s.width),y:-t,size:t,hue:x(0,360),speed:x(20,150)})}function Ve(e){for(let t=0;t<Q.length;t++){const n=Q[t];e.bubbleGradient(n.x,n.y,n.size,K(n.hue)),e.disk(n.x,n.y,n.size)}e.fillStyle="#FFFFFFCC",e.fillRect(0,0,s.width,s.height)}function Ue(e){for(let t=Q.length-1;t>0;t--){const n=Q[t];n.y+=n.speed*e,n.y>s.height+n.size&&Q.splice(t,1)}Math.random()<.05&&ct()}function pt(e){e.fontSize(8),e.textCenter(),e.fillText("13 Bubbles",s.width/2,200),e.save(),e.translate(300,600);const t=130;fe(e,0,0,t,K(180),"Play",6,!1),fe(e,t*1.3,-t,60,K(90),"Easy",2)&&(J("interact"),te(ee.game,{difficulty:0})),fe(e,t*1.7,0,60,K(50),"Normal",2)&&(J("interact"),te(ee.game,{difficulty:1})),fe(e,t*1.3,t,60,K(0),"Hard",2)&&(J("interact"),te(ee.game,{difficulty:2})),e.restore(),e.fontSize(2),e.fillText("Made by @NoNiMad",s.width/2,s.height-60),e.fontSize(1),e.fillText("Using zzfx(m)",s.width/2,s.height-30)}function fe(e,t,n,i,o,l,f,r){if(e.bubbleGradient(t,n,i,o),e.disk(t,n,i),e.fontSize(f),e.textCenter(),e.fillStyle="black",e.fillText(l,t,n),r===!1)return!1;const c=new DOMPoint(t,n).matrixTransform(e.getTransform());return!!(rt(c.x,c.y,u.x,u.y)<i&&(e.lineWidth=2,e.strokeStyle="black",e.circle(t,n,i),u.up))}function yt(){Ce(Ue),Se(Ve),Se(pt),ue("m",()=>{Ae()})}function gt(){}const mt=Object.freeze(Object.defineProperty({__proto__:null,onEnter:yt,onLeave:gt},Symbol.toStringTag,{value:"Module"})),d=52,R=13,w=39,Xe=.39,Fe=13*80,wt=13*50;let M,G,a,xe,N,V,k,ne,U,he,ge,F,me,Pe,ze,B,A,we;function Te(){return x(0,3)==0?-x(1,7):x(1,8)}function bt(){return{value:Te(),color:x(0,G.length)}}function qe(){He(),a.unshift([]),xe+=1;for(let e=0;e<R;e++)a[0].push(bt());Ee((e,t,n)=>{n.gridPos=p(e,t),n.pos=Ye(n.gridPos)})}function He(){for(let e=a.length-1;e>=0;e--){for(let t=0;t<R;t++)if(a[e][t]!==null)return;a.splice(e,1)}}function Ye(e){const t=d*(.5+e.y*7/8),n=w+(e.x+.5+ve(e.y)/2)*d;return p(n,t)}function Ze(e,t){const n=Math.floor(e.y*8/(d*7)-.5714285714285714+.5),i=Math.floor((e.x-w)/d-ve(n)/2);return!t&&(i<0||i>=R||n<0||n>=a.length)?null:p(i,n)}function St(e){const t=Ze(e);return t==null?null:a[t.y][t.x]}function Mt(e,t){return((e.x-t.pos.x)**2+(e.y-t.pos.y)**2)**.5}function ve(e){return(e+xe)%2}function Ee(e){for(let t=0;t<a.length;t++){const n=a[t];for(let i=0;i<n.length;i++){let o=n[i];if(o!==null&&e(i,t,o)===!1)return}}}function We(e){let t=e.gridPos.x,n=e.gridPos.y,i=[],o=ve(n)==0,l=o?-1:0;return t>0&&i.push(a[n][t-1]),t<R-1&&i.push(a[n][t+1]),n>0&&((t>0||!o)&&i.push(a[n-1][t+l]),(t<R-1||o)&&i.push(a[n-1][t+1+l])),n<a.length-1&&((t>0||!o)&&i.push(a[n+1][t+l]),(t<R-1||o)&&i.push(a[n+1][t+1+l])),i.filter(f=>f!=null)}function Ke(e){let t=new Set,n=[e];for(;n.length!=0;)n=n.flatMap(i=>(t.add(i),We(i).filter(o=>o.color===e.color&&!t.has(o))));return[...t]}function kt(){const e=new Set(a.flatMap(t=>t.filter(n=>n!=null)));for(let t of a[0]){if(t==null||!e.has(t))continue;let n=new Set([t]),i,o;for(;n.size!=0;){i=n.values().next().value,e.delete(i),n.delete(i),o=We(i);for(let l=0;l<o.length;l++)e.has(o[l])&&n.add(o[l])}}return[...e]}function Pt(e){const t=e.createLinearGradient(w,0,0,0);t.addColorStop(0,"#00000000"),t.addColorStop(1,G[U]),e.fillStyle=t,e.fillRect(0,0,w,s.height);const n=e.createLinearGradient(s.width-w,0,s.width,0);if(n.addColorStop(0,"#00000000"),n.addColorStop(1,G[U]),e.fillStyle=n,e.fillRect(s.width-w,0,s.width,s.height),e.lineWidth=1,e.line(w-1,0,w-1,s.height),e.line(s.width-w+1,0,s.width-w+1,s.height),Ee((i,o,l)=>{ce(e,l.pos,l)}),!A){zt(e);for(let i of ne)ce(e,i.pos,i);V.forEach(i=>ce(e,i.pos,i)),e.textAlign="left",e.fillStyle="black",e.fillText("Score: "+we,w*1.5,s.height-d),e.fillText("Next line in: "+(M.shotsBetweenLine-ge%M.shotsBetweenLine),w*1.5,s.height-d/2),Ct(e)}(A||B)&&(e.textCenter(),e.fillStyle="#FFFFFFBB",e.fillRect(0,0,s.width,s.height),e.fillStyle="black",e.fontSize(8),e.fillText(A?"Game Over!":"Paused",s.width/2,s.height/2-100),e.fontSize(4),e.fillText("Score: "+we,s.width/2,s.height/2),e.fontSize(1),e.fillText("Click anywhere to "+(A?"go back to the main menu":"resume game"),s.width/2,s.height/2+200),B&&e.fillText("Press Q to go back to the main menu",s.width/2,s.height/2+220))}function zt(e){e.lineWidth=2,e.lineDir(F.x,F.y,me,d*2),k[0]!=null&&ce(e,F,{value:k[0],color:U}),e.save(),e.translate(s.width/2,s.height);for(let t=1;t<k.length;t++)e.fillStyle="black",e.fillText(k[t],t*(d+13),-d/2);e.restore()}function Ct(e){if(N.length==0)return;let t=0,n=0,i=0;N.forEach(f=>{t+=f.value,i+=f.pos.x,n=Math.max(n,f.pos.y)});let o={x:i/N.length,y:n+d};e.fillStyle="black",e.disk(o.x,o.y,d/2),e.fontSize(1.8),e.textCenter();const l=t%13;l>0?e.fillText(`${t-l} < ${t-l+13}`,o.x,o.y+d):l<0&&e.fillText(`${t-l-13} < ${t-l}`,o.x,o.y+d),e.fillStyle="white",e.fillText(t,o.x,o.y)}function ce(e,t,n){e.bubbleGradient(t.x,t.y,d/2,G[n.color]),e.disk(t.x,t.y,d/2),N.includes(n)&&(e.lineWidth=2,e.strokeStyle="black",e.circle(t.x,t.y,d/2-1)),e.fontSize(1.8),e.textCenter(),e.fillStyle="black",e.fillText(n.value,t.x,t.y)}function Lt(e){if(A){u.down&&te(ee.menu);return}if(B){u.down&&(B=!1);return}for(let t=V.length-1;t>=0;t--){const n=V[t];if(n.pos.x<-d||n.pos.x>s.width+d||n.pos.y>s.height+d){V.splice(t,1),vt(n);continue}n.speed.y+=wt*e,n.pos.x+=n.speed.x*e,n.pos.y+=n.speed.y*e}me=ye(u.x-F.x,Math.min(u.y,F.y-13)-F.y),Tt(e),xt()}function xt(){const e=St(p(u.x,u.y));N=e!=null?Ke(e):[]}function Tt(e){if(u.wheel!=0){let t=u.wheel>0?-1:1,n=U+t;n>=G.length?n=0:n<0&&(n=G.length-1),U=n,J("interact")}he>Xe?(k[0]==null&&(k.shift(),k.push(Te())),u.down&&(ge++,ne.push({value:k[0],color:U,pos:{...F},speed:p(me.x*Fe,me.y*Fe),addLineOnCollision:ge%M.shotsBetweenLine==0}),k[0]=null,he=0,J("shoot"))):he+=e;for(let t of ne)if(t.pos.x+=t.speed.x*e,t.pos.y+=t.speed.y*e,t.pos.x<Pe&&(t.pos.x=Pe,t.speed.x=-t.speed.x),t.pos.x>ze&&(t.pos.x=ze,t.speed.x=-t.speed.x),t.pos.y<d/2){const n=d/2-t.pos.y,i=ye(t.speed),o=p(t.pos.x-i.x*n,t.pos.y-i.y*n);Ge(t,o)}else Ee((n,i,o)=>{const l=Mt(t.pos,o);if(l<=d){const f=d-l,r=ye(t.speed),c=p(t.pos.x-r.x*f,t.pos.y-r.y*f);return Ge(t,c),!1}})}function Ge(e,t){ne.splice(ne.indexOf(e),1);const n=Ze(t,!0);if(n.y>25){_e();return}n.x=Re(n.x,0,R-1),n.y=Re(n.y,0,a.length),n.y==a.length&&a.push(new Array(R).fill(null)),e.gridPos=n,a[n.y][n.x]=e;const i=Ke(e),o=i.reduce((l,f)=>l+f.value,0);if(o%13==0){const l=Math.min(Math.abs(o)/13,1);i.forEach(r=>{a[r.gridPos.y][r.gridPos.x]=null,r.speed=r==e?Me(r.speed,p(130,260)):Me(p(r.pos.x-e.pos.x,r.pos.y-e.pos.y),p(130,260)),delete r.gridPos,r.multiplier=l}),V.push(...i);const f=kt();f.forEach(r=>{a[r.gridPos.y][r.gridPos.x]=null,r.speed=Me(p(r.pos.x-e.pos.x,r.pos.y-e.pos.y),p(10,260)),delete r.gridPos,r.multiplier=l}),V.push(...f),J("explode"),He()}else e.pos=Ye(n);e.addLineOnCollision&&(qe(),a.length>26&&_e())}function vt(e){we+=Math.abs(e.value*e.multiplier)}function _e(){A=!0,N=[]}function Et(e){if(Ce(Ue),Se(Ve),Se(Pt),Ce(Lt),ue("Escape",()=>{B=!B}),ue("q",()=>{B&&te(ee.menu)}),ue("m",()=>{Ae()}),a=[],N=[],V=[],xe=0,ne=[],U=0,ge=0,he=Xe,F=p(s.width/2,s.height-d),Pe=w+d/2,ze=s.width-w-d/2,A=!1,B=!1,we=0,e.difficulty!==void 0)switch(e.difficulty){case 0:M={initialLines:3,numberOfColors:2,nextValuesCount:5,shotsBetweenLine:5};break;case 1:M={initialLines:5,numberOfColors:3,nextValuesCount:4,shotsBetweenLine:5};break;case 2:M={initialLines:7,numberOfColors:4,nextValuesCount:3,shotsBetweenLine:5};break}else M=e.gameConfig;G=[];const t=x(0,360);for(let n=0;n<M.numberOfColors;n++)G.push(K(t+n*360/M.numberOfColors));for(let n=0;n<M.initialLines;n++)qe();k=[];for(let n=0;n<M.nextValuesCount;n++)k.push(Te())}const Ot=Object.freeze(Object.defineProperty({__proto__:null,onEnter:Et},Symbol.toStringTag,{value:"Module"})),Bt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),s={};let b,re=1;function Rt(){const e=document.querySelector("canvas");s.element=e,s.boundingRect=e.getBoundingClientRect(),s.width=e.width,s.height=e.height,b=e.getContext("2d"),ot(e),it(b),O=performance.now(),be=O-Je,window.addEventListener("resize",De),De(),e.addEventListener("focus",()=>{ht(),Le()},{once:!0}),te(ee.menu),Qe()}function De(){re=Math.min(window.innerHeight/1280,1),s.element.width=780*re,s.element.height=1280*re}const Ft=144,Je=1e3/Ft;let O,be;function Qe(){let e=O;O=performance.now();let t=O-e;_t(t/1e3),O-be>=Je&&(Gt(),be=O),lt(),requestAnimationFrame(Qe)}function Gt(){b.save(),b.scale(re,re),b.fillStyle="white",b.fillRect(0,0,s.width,s.height),b.fillStyle="black",b.fillText(Math.floor(1e3/(O-be)),10,20),Oe.forEach(e=>{b.save(),e(b),b.restore()}),b.restore()}function _t(e){Be.forEach(t=>t(e))}let Oe=[],Be=[];function Se(e){Oe.push(e)}function Ce(e){Be.push(e)}const ee={menu:mt,game:Ot,customGame:Bt};let I=null;function te(e,t){var n;(n=I==null?void 0:I.onLeave)==null||n.call(I),Oe=[],Be=[],$e(),I=e,I.onEnter(t)}window.addEventListener("load",Rt);
